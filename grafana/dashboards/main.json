{
  "annotations": { "list": [] },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 0 },
      "id": 1,
      "title": "EC2 CPU Usage",
      "type": "timeseries",
      "targets": [ { "expr": "100 - (avg by (instance) (irate(node_cpu_seconds_total{mode='idle'}[1m])) * 100)", "legendFormat": "CPU Load" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "color": { "mode": "thresholds" }, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 80 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 0 },
      "id": 2,
      "title": "EC2 RAM Usage",
      "type": "timeseries",
      "targets": [ { "expr": "(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100", "legendFormat": "RAM Used" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "max": 100, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 85 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 0 },
      "id": 3,
      "title": "Disk Usage (Root)",
      "type": "gauge",
      "targets": [ { "expr": "100 - ((node_filesystem_avail_bytes{mountpoint='/'} * 100) / node_filesystem_size_bytes{mountpoint='/'})", "legendFormat": "Disk Used" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "max": 100, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 90 } ] } } }
    },
    {
      "gridPos": { "h": 12, "w": 24, "x": 0, "y": 8 },
      "id": 4,
      "title": "Docker Container Metrics",
      "type": "table",
      "targets": [
        { 
          "expr": "sum by (name, image, id) (rate(container_cpu_usage_seconds_total{id=~\".*docker.*\"}[1m])) * 100", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "CPU" 
        },
        { 
          "expr": "sum by (name, image, id) (container_memory_usage_bytes{id=~\".*docker.*\"})", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "RAM" 
        }
      ],
      "transformations": [
        { "id": "merge", "options": {} },
        { 
           "id": "organize", 
           "options": { 
             "excludeByName": {}, 
             "indexByName": {}, 
             "renameByName": { "id": "Container ID / Path", "name": "Name", "image": "Image" } 
           } 
        }
      ],
      "fieldConfig": { "defaults": { "unit": "short" }, "overrides": [ { "matcher": { "id": "byName", "options": "Value #A" }, "properties": [ { "id": "unit", "value": "percent" }, { "id": "displayName", "value": "CPU" } ] }, { "matcher": { "id": "byName", "options": "Value #B" }, "properties": [ { "id": "unit", "value": "bytes" }, { "id": "displayName", "value": "RAM" } ] } ] }
    }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["automated"],
  "templating": { "list": [] },
  "time": { "from": "now-1h", "to": "now" },
  "title": "Master Node Overview",
  "uid": "master-node-01",
  "version": 1
}