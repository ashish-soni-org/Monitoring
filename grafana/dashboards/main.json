{
  "annotations": { "list": [] },
  "editable": true,
  "gnetId": null,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "panels": [
    {
      "gridPos": { "h": 8, "w": 8, "x": 0, "y": 0 },
      "id": 1,
      "title": "EC2 CPU Usage",
      "type": "timeseries",
      "targets": [ { "expr": "100 - (avg by (instance) (irate(node_cpu_seconds_total{mode='idle'}[1m])) * 100)", "legendFormat": "CPU Load" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "color": { "mode": "thresholds" }, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 80 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 8, "y": 0 },
      "id": 2,
      "title": "EC2 RAM Usage",
      "type": "timeseries",
      "targets": [ { "expr": "(node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes) / node_memory_MemTotal_bytes * 100", "legendFormat": "RAM Used" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "max": 100, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 85 } ] } } }
    },
    {
      "gridPos": { "h": 8, "w": 8, "x": 16, "y": 0 },
      "id": 3,
      "title": "Disk Usage (Root)",
      "type": "gauge",
      "targets": [ { "expr": "100 - ((node_filesystem_avail_bytes{mountpoint='/'} * 100) / node_filesystem_size_bytes{mountpoint='/'})", "legendFormat": "Disk Used" } ],
      "fieldConfig": { "defaults": { "unit": "percent", "max": 100, "thresholds": { "mode": "absolute", "steps": [ { "color": "green", "value": null }, { "color": "red", "value": 90 } ] } } }
    },
    {
      "gridPos": { "h": 12, "w": 24, "x": 0, "y": 8 },
      "id": 4,
      "title": "Application Metrics (Business Only)",
      "type": "table",
      "targets": [
        { 
          "expr": "sum by (name) (rate(container_cpu_usage_seconds_total{id!=\"/\"}[1m]) * on(id) group_left(name) container_meta_info{name!~\"monitoring_.*\"}) * 100", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "CPU" 
        },
        { 
          "expr": "sum by (name) (container_memory_usage_bytes{id!=\"/\"} * on(id) group_left(name) container_meta_info{name!~\"monitoring_.*\"})", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "RAM" 
        },
        { 
          "expr": "sum by (name) ((time() - container_start_time_seconds{id!=\"/\"}) * on(id) group_left(name) container_meta_info{name!~\"monitoring_.*\"})", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "Uptime" 
        },
        { 
          "expr": "sum by (name) (container_meta_info{name!~\"monitoring_.*\"})", 
          "format": "table", 
          "instant": true, 
          "legendFormat": "Status" 
        }
      ],
      "transformations": [
        { "id": "merge", "options": {} },
        { 
           "id": "organize", 
           "options": { 
             "excludeByName": {}, 
             "indexByName": {}, 
             "renameByName": { "name": "Application Name", "Value #A": "CPU %", "Value #B": "RAM Usage", "Value #C": "Uptime", "Value #D": "Health Status" } 
           } 
        }
      ],
      "fieldConfig": { 
        "defaults": { "unit": "short" }, 
        "overrides": [ 
          { "matcher": { "id": "byName", "options": "CPU %" }, "properties": [ { "id": "unit", "value": "percent" } ] }, 
          { "matcher": { "id": "byName", "options": "RAM Usage" }, "properties": [ { "id": "unit", "value": "bytes" } ] },
          { 
            "matcher": { "id": "byName", "options": "Uptime" }, 
            "properties": [ 
              { "id": "unit", "value": "s" }, 
              { "id": "thresholds", "value": { "mode": "absolute", "steps": [ { "color": "red", "value": null }, { "color": "orange", "value": 60 }, { "color": "green", "value": 300 } ] } } 
            ] 
          },
          { 
            "matcher": { "id": "byName", "options": "Health Status" }, 
            "properties": [ 
              { "id": "mappings", "value": [ { "type": "value", "options": { "1": { "color": "green", "index": 0, "text": "RUNNING" } } } ] } 
            ] 
          } 
        ] 
      }
    }
  ],
  "refresh": "5s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["automated"],
  "templating": { "list": [] },
  "time": { "from": "now-1h", "to": "now" },
  "title": "Master Node Overview",
  "uid": "master-node-01",
  "version": 1
}